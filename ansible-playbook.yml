---
- hosts: build-host
  vars:
    packages: 
      - git
      - default-jdk
      - maven
    app_dir: /root/project
    repo_url: https://github.com/boxfuse/boxfuse-sample-java-war-hello.git
  become: yes
  tasks:
  - name: install packages
    apt:
      name: "{{item}}"
      state: latest
      update_cache: yes
    with_items:
      "{{packages}}"
  - name: clone pom.xml
    git:
      repo: "{{repo_url}}"
      dest: "{{app_dir}}"
      clone: yes
  - name: build war app
    shell: mvn package -f "{{app_dir}}"/boxfuse-sample-java-war-hello/pom.xml